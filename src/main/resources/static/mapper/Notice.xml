<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="fragrantia.fragrantiaadminserver.domain.notice.NoticeMapper">

    <insert id="create" parameterType="fragrantia.fragrantiaadminserver.domain.notice.Notice" useGeneratedKeys="true"
            keyProperty="id">
        INSERT INTO NOTICE(title, content, created_at, admin_id)
        VALUES (
        #{title},
        #{content},
        #{createdAt},
        #{adminId}
        )
    </insert>

    <select id="getNotice" parameterType="long" resultType="fragrantia.fragrantiaadminserver.domain.notice.Notice">
        SELECT id, admin_id, title, content, view, created_at AS createdAt
        FROM NOTICE
        WHERE id=#{noticeId}
    </select>

    <select id="getNoticesWithPaging" resultType="fragrantia.fragrantiaadminserver.controller.dto.GetNoticesDto">
        SELECT n.id, a.name, n.title, n.content, n.view, n.created_at AS createdAt
        FROM NOTICE n
        INNER JOIN ADMIN a ON n.admin_id = a.id
        ORDER BY n.id DESC
        LIMIT #{offset}, #{limit}
    </select>

    <select id="getTotalNoticeCount" resultType="int">
        SELECT COUNT(id) FROM NOTICE
    </select>

</mapper>
